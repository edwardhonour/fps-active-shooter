<div class="container-fluid">
  <div class="container-fluid"  style="background-color: #17213f;">
        <app-page-header [data]="data" (loadingChanged)="getLoading($event)"></app-page-header>

    <div *ngIf="loading!='Y'" class="container-fluid"  style="background-color: whitesmoke;">
            <!-- Facility Information -->
            <div class="row" style="background-color: wheat;">
                <div class="col-md-3">
                    <div>&nbsp;</div>
                </div>
            </div>
            <div class="row" style="background-color: wheat;">
            <div class="col-md-2">
                <div class="p-2">Select a Template: </div>
            </div>
            <div class="col-md-3">
                <select [(ngModel)]="current_template" class="form-control" style="width:300px;">
                    <option value="">-- Select a Template --</option>
                    <option  *ngFor="let m of data.templates" value="{{ m.TEMPLATE_ID }}">{{ m.TEMPLATE_NAME }}</option>
                </select>
            </div>
            <div class="col-md-2">

            </div>
            </div>
            <div class="row pt-3 pb-3" style="background-color: wheat;">
                <div class="col-md-2">
                    <div class="p-2">Enter a Building: </div>
                </div>
                <div class="col-md-1">
                    <input [(ngModel)]="building_nbr" class="form-control" style="width:100px;">
                </div>
                <div class="col-md-2">
                    <button [routerLink]="['/plan',current_template,building_nbr,'100']" class="btn btn-primary" style="width:120px;">Go</button>
                </div>
                </div>
            <div class="row mt-3 mb-3 p-3" style="background-color: lightgrey">
                <div class="col-md-5">
                         <button (click)="showAdd();" class="m-2 btn btn-primary">New Template</button>
                         <button [routerLink]="['/data-sources']" class="m-2 btn btn-primary">Data Sources</button>
                </div>            
            </div>
    
<!-- Main Section -->
<div *ngIf="adding=='Y'" class="row">
    <div *ngIf="adding=='Y'" class="col-md-12">
        <div class="container-fluid" style="background-color: white;">
            <div class="row">
            <div class="col-md-3"></div>
            <div class="col-md-5">
                <h2>Add Security Plan Template</h2>
                <table class="table table-responsive table-striped table-bordered border-primary">
                    <thead>
                        <tr class="p-2">
                            <th  class="p-2">CODE</th>
                            <th  class="p-2">NAME</th>     
                            <th></th>                   
                        </tr>
                    </thead>
                    <tbody>
                        <tr  class="p-2">
                            <td  class="p-2" style="width:100px">
                                <input type="text" [(ngModel)]="data.formData['TEMPLATE_ID']" 
                                class="form-control" id="TEMPLATE_ID"></td>
                            <td  class="p-2"> 
                                <input type="text" class="form-control" 
                                id="TEMPLATE_NAME" [(ngModel)]="data.formData['TEMPLATE_NAME']"></td>
                            <td  class="p-2">
                            <button (click)="postForm();" class="btn btn-primary m-1" >Save</button>
                            <button (click)="showAdd();" class="btn btn-warning m-1" >Cancel</button>
                        </tr>
                    </tbody>
                </table>
      </div>
      </div>
    </div>
    </div>
    </div>

<div *ngIf="adding=='N'||loading=='N'" class="row">
    <div class="col-md-12">
    <div class="container-fluid" style="background-color: white;">
        <div class="row">
            <div class="col-md-3"></div>
            <div class="col-md-5">
                <h2>Security Plan Templates</h2>
                <table class="table table-responsive table-striped table-bordered border-primary">
                    <thead>
                        <tr class="p-2">
                            <th  class="p-2">CODE</th>
                            <th  class="p-2">NAME</th>     
                            <th></th>                   
                        </tr>
                    </thead>
                    <tbody>
                        <tr  class="p-2" *ngFor="let m of data.templates">
                            <td  class="p-2" style="width:100px">{{ m.TEMPLATE_ID }}</td>
                            <td  class="p-2">{{ m.TEMPLATE_NAME }}</td>
                            <td  class="p-2" style="width:100px;">
                            <button [routerLink]="['/instructions',m.TEMPLATE_ID,100]" class="btn btn-primary" >Edit</button>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="col-md-3"></div>
        </div>
    </div>
</div>
</div>
</div>
</div>
</div>